manifest {
    name = 'Mono INH analysis'
    description = 'Workflow for the Mono INH concerning MTB'
    version = '0.1.0'
    author = 'Abhinav Sharma <abhi18av@outlook.com>; Emilyn Costa Conceição <emilyncosta@gmail.com>'
    mainScript = 'main.nf'
}


process {
    errorStrategy = 'retry'
    maxRetries = 3
}

profiles {
    labbactfiocruz {

        params {

            outdir = "$baseDir/results"

            gatk38_jar = "$baseDir/resources/GenomeAnalysisTK.jar"

            reads = "$baseDir/data/full_data/*_{R1,R2}*fastq.gz"

            mtbseq_library_name = "somelib"

            mtbseq_project_name= "MonoINH"

            resultsDir_mtbseq_cohort= "$params.outdir/mtbseq/cohort"
        }

        docker.enabled = true

        process {

            withName:
            FASTQC* {
                cpus = 4
                memory = '7 GB'
            }


            withName:
            TRIMMOMATIC {
                cpus = 4
                memory = '7 GB'
            }

            withName:
            MTBSEQ* {
                cpus = 8
                memory = '15 GB'
            }

            withName:
            TBPROFILER* {
                cpus = 8
                memory = '15 GB'
            }

            withName:
            SPADES {
                cpus = 8
                memory = '15 GB'
            }

            withName:
            PROKKA {
                cpus = 8
                memory = '15 GB'
            }

            withName:
            RDANALYZER {
                cpus = 4
                memory = '7 GB'
            }
            withName:
            SPOTYPING {
                cpus = 4
                memory = '7 GB'
            } 
            
            withName:
            QUAST {
                cpus = 8
                memory = '15 GB'
            }

//            FASTQC
//            TRIMMOMATIC
//            FASTQC_TRIMMED
//            MTBSEQ_PER_SAMPLE
//            MTBSEQ_COHORT
//            RDANALYZER
//            SPOTYPING
//            SPADES
//            PROKKA
//            QUAST
//            TBPROFILER_PROFILE
//            TBPROFILER_COLLATE


        }
    }

    aws_batch {
        aws.client.uploadMaxThreads = 4
    }

    google_cloud_life_sciences {
        process.executor = 'google-lifesciences'
        workDir = 'gs://mtb-mono-inh-nf-bucket/work/'
        google.zone = 'us-west1-b'
        google.project = 'mtb-mono-inh-nf'

    }

}

